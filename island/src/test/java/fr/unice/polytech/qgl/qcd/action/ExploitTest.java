package fr.unice.polytech.qgl.qcd.action;

import fr.unice.polytech.qgl.qcd.database.Resource;
import org.json.JSONException;
import org.junit.Before;
import org.junit.Test;

import static org.junit.Assert.assertEquals;

/**
 * @author Mathias Chevalier
 * @school Polytech' Nice
 * @date 14/11/2015
 */
public class ExploitTest {
    ActionExplorer referenceBasic;
    ActionExplorer referenceManufactured;

    @Before
    public void setUp() throws Exception {
        this.referenceBasic = new Exploit(Resource.FUR);
        this.referenceManufactured = new Exploit(Resource.INGOT);
    }

    @Test
    public void createExploitAction()throws JSONException {
        ActionExplorer exploitActionBas = new Exploit(Resource.FUR);
        Exploit exploitExploitMan = new Exploit(Resource.INGOT);
        assertEquals(referenceBasic, exploitActionBas);
        assertEquals(referenceBasic.getRes(), exploitActionBas.getRes());
        assertEquals(referenceManufactured, exploitExploitMan);
        assertEquals(referenceManufactured.getRes(), exploitExploitMan.getRes());
    }

    @Test
    public void ackTest() throws Exception {
        referenceBasic.catchResponse("{ \"cost\": 3, \"extras\": {\"amount\": 9}, \"status\": \"OK\" }");
        referenceBasic.analyze();
        assertEquals(3, referenceBasic.getCost());
        assertEquals(9, referenceBasic.getAmount());
    }
}